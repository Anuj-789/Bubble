<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>3D Bubble Crusher Game</title>
<style>
:root{
  --bg:#0f172a;
  --circle:#1e293b;
  --score:#facc15;
}
body{
  margin:0;
  background:var(--bg);
  font-family:sans-serif;
  display:flex;
  justify-content:center;
  align-items:center;
  height:100vh;
  overflow:hidden;
}
#gameContainer{
  position:relative;
  width:90vw;
  max-width:600px;
  height:90vh;
  border-radius:20px;
  background:rgba(30,41,59,0.8);
  overflow:hidden;
  box-shadow:0 0 50px rgba(99,102,241,.5);
  perspective:1000px;
}

/* Middle Circle */
#middleCircle{
  position:absolute;
  width:150px;
  height:150px;
  border-radius:50%;
  background:rgba(99,102,241,0.2);
  border:4px solid #6366f1;
  z-index:2;
  box-shadow:0 0 20px #6366f1;
  cursor:grab;
}

/* Score */
#scoreBoard{
  position:absolute;
  top:10px;
  left:50%;
  transform:translateX(-50%);
  color:var(--score);
  font-size:24px;
  font-weight:bold;
  text-shadow:0 0 10px #facc15;
  z-index:5;
}

/* Game Over */
#gameOver{
  position:absolute;
  inset:0;
  display:flex;
  justify-content:center;
  align-items:center;
  background:rgba(0,0,0,.7);
  color:#f87171;
  font-size:32px;
  font-weight:bold;
  display:none;
  flex-direction:column;
  z-index:10;
  text-align:center;
}
#gameOver button{
  margin-top:20px;
  padding:10px 20px;
  font-size:18px;
  border:none;
  border-radius:10px;
  cursor:pointer;
  background:linear-gradient(135deg,#6366f1,#22d3ee);
  color:white;
  box-shadow:0 5px 20px rgba(0,0,0,.3);
  transition:transform .2s;
}
#gameOver button:hover{
  transform:scale(1.1);
}

/* Bubble style */
.bubble{
  position:absolute;
  width:40px;
  height:40px;
  border-radius:50%;
  cursor:pointer;
  box-shadow:0 0 15px rgba(255,255,255,.5);
  transition:transform 0.2s ease;
}
.bubble:active{
  transform:scale(1.3);
}
</style>
</head>
<body>

<div id="gameContainer">
  <div id="scoreBoard">Score: 0</div>
  <div id="middleCircle"></div>
  <div id="gameOver">
    <div>Game Over ðŸ˜¢</div>
    <button onclick="restartGame()">Replay</button>
  </div>
</div>

<script>
const gameContainer = document.getElementById("gameContainer");
const middleCircle = document.getElementById("middleCircle");
const scoreBoard = document.getElementById("scoreBoard");
const gameOverEl = document.getElementById("gameOver");

let bubbles = [];
let score = 0;
let gameRunning = true;

const bubbleColors = ["#22d3ee","#f472b6","#34d399","#facc15","#a78bfa","#f87171"];

let baseSpeed = 2;
let speedMultiplier = 0;

// Increase speed every 10 seconds
setInterval(()=>{
  if(gameRunning) speedMultiplier+=0.5;
},10000);

// Middle Circle drag
const circleWidth = 150, circleHeight = 150;
let circlePos = {x: (gameContainer.clientWidth-circleWidth)/2, y:(gameContainer.clientHeight-circleHeight)/2};
let dragging=false;
let dragOffset={x:0,y:0};

function updateCircle(){
  middleCircle.style.left = circlePos.x+"px";
  middleCircle.style.top = circlePos.y+"px";
  requestAnimationFrame(updateCircle);
}
requestAnimationFrame(updateCircle);

function dragStart(e){
  dragging=true;
  const clientX = e.clientX ?? e.touches[0].clientX;
  const clientY = e.clientY ?? e.touches[0].clientY;
  dragOffset.x = clientX - circlePos.x;
  dragOffset.y = clientY - circlePos.y;
}
function dragMove(e){
  if(!dragging) return;
  const clientX = e.clientX ?? e.touches[0].clientX;
  const clientY = e.clientY ?? e.touches[0].clientY;
  circlePos.x = clientX - dragOffset.x;
  circlePos.y = clientY - dragOffset.y;

  // Keep circle fully inside container
  circlePos.x = Math.max(0, Math.min(gameContainer.clientWidth - circleWidth, circlePos.x));
  circlePos.y = Math.max(0, Math.min(gameContainer.clientHeight - circleHeight, circlePos.y));
}
function dragEnd(){dragging=false;}

middleCircle.addEventListener("mousedown", dragStart);
window.addEventListener("mousemove", dragMove);
window.addEventListener("mouseup", dragEnd);
middleCircle.addEventListener("touchstart", dragStart);
window.addEventListener("touchmove", dragMove);
window.addEventListener("touchend", dragEnd);

// Bubble creation
function random(min,max){return Math.floor(Math.random()*(max-min+1))+min;}
function createBubble(fromTop=true){
  if(!gameRunning) return;
  const bubble = document.createElement("div");
  bubble.classList.add("bubble");
  bubble.style.left = random(0, gameContainer.clientWidth-40) + "px";
  bubble.style.background = bubbleColors[random(0,bubbleColors.length-1)];
  bubble.style.boxShadow=`0 0 15px ${bubble.style.background},0 0 30px ${bubble.style.background}80`;
  if(fromTop){
    bubble.style.top="-50px";
    bubble.direction="down";
  } else {
    bubble.style.top=gameContainer.clientHeight+"px";
    bubble.direction="up";
  }
  gameContainer.appendChild(bubble);
  bubbles.push(bubble);
}

// Animate bubbles
function animateBubbles(){
  if(!gameRunning) return;
  const cRect = middleCircle.getBoundingClientRect();
  bubbles.forEach(bubble=>{
    let top=parseFloat(bubble.style.top);
    const speed = baseSpeed + speedMultiplier;
    top += bubble.direction==="down"?speed:-speed;
    bubble.style.top = top+"px";

    // collision
    const bRect = bubble.getBoundingClientRect();
    const dx=(bRect.left+bRect.width/2)-(cRect.left+cRect.width/2);
    const dy=(bRect.top+bRect.height/2)-(cRect.top+cRect.height/2);
    const dist=Math.sqrt(dx*dx+dy*dy);
    if(dist < cRect.width/2){
      score++;
      scoreBoard.textContent="Score: "+score;
      bubble.remove();
      bubbles=bubbles.filter(b=>b!==bubble);
    }

    // game over
    if(bubble.direction==="down" && top>gameContainer.clientHeight){
      endGame();
    } else if(bubble.direction==="up" && top+40<0){
      endGame();
    }
  });
  requestAnimationFrame(animateBubbles);
}

// Spawn bubbles
setInterval(()=>createBubble(true),800);
setInterval(()=>createBubble(false),1000);

function endGame(){
  gameRunning=false;
  gameOverEl.style.display="flex";
}

function restartGame(){
  gameRunning=true;
  score=0;
  speedMultiplier=0;
  scoreBoard.textContent="Score: 0";
  gameOverEl.style.display="none";
  bubbles.forEach(b=>b.remove());
  bubbles=[];
  animateBubbles();
}

// Start animation
animateBubbles();
</script>

</body>
</html>